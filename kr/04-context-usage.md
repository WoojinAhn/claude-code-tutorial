# 모듈 4: 컨텍스트와 사용량

Claude Code에는 "컨텍스트 윈도우"라는 제한이 있습니다. 대화가 길어지면 초반 내용을 잊어버리기 시작합니다.

이 모듈에서는 컨텍스트를 효율적으로 관리하는 방법과, 사용량을 모니터링하는 커맨드를 배웁니다.

---

## 4.1 /compact

**설명:** `/compact`는 지금까지의 대화를 요약해서 압축합니다. 컨텍스트 윈도우가 부족해질 때, 대화 내용을 버리지 않으면서도 공간을 확보할 수 있는 방법입니다.

**문법:**
```
/compact
/compact [커스텀 요약 지시]
```

**예시:** `/compact`를 실행하면 긴 대화가 핵심만 남긴 요약으로 대체됩니다. 커스텀 지시를 추가하면 특정 부분을 강조할 수도 있습니다:
```
/compact 아키텍처 관련 논의 위주로 요약해줘
```

이전 대화에서 나온 코드, 결정사항, 맥락은 요약에 포함되므로 작업을 이어갈 수 있습니다.

**`/compact`와 `/clear`의 차이:**

| | /compact | /clear |
|---|---------|--------|
| 대화 기록 | 요약해서 보존 | 완전 삭제 |
| 이전 맥락 | 요약으로 유지 | 사라짐 |
| 사용 시점 | 긴 세션, 컨텍스트 부족 | 완전히 새 작업 시작 |

**실습:** `/compact`를 실행해보세요. 요약 후에도 **이 튜토리얼에서 배운 커맨드 이름이 남아있는지** 확인해보세요. 하나 알려주세요.

> **참고:** `/compact`를 실행하면 이전 대화가 짧은 요약으로 대체되면서 화면이 확 바뀝니다. 마치 대화가 리셋된 것처럼 보일 수 있지만, 걱정하지 마세요 — 핵심 맥락은 요약 안에 보존되어 있고, 이 튜토리얼도 그대로 이어집니다. 새로 시작하는 게 아니라, 같은 대화를 압축한 것입니다.
>
> 요약된 내용이 궁금하다면, compact 직후 화면에 표시되는 단축키 안내를 확인하세요 — 요약 내용을 펼쳐볼 수 있습니다.

**확인:** 사용자가 보고한 키워드를 확인합니다. 요약은 핵심 맥락을 보존하면서 세부사항을 줄입니다. 대화가 짧으면 효과가 미미할 수 있지만, 긴 세션에서 진가를 발휘합니다.

**팁:** Claude가 "아까 말한 그거"를 갑자기 못 알아듣기 시작하면, 컨텍스트 윈도우가 한계에 도달한 신호입니다. 그때 `/compact`를 쓰세요. 주요 작업을 마칠 때마다 습관적으로 compact하면 세션이 계속 쾌적합니다.

---

## 4.2 /context

**설명:** `/context`는 현재 컨텍스트 윈도우 사용량을 컬러 그리드로 시각화합니다. Claude의 "기억 공간"이 얼마나 사용됐는지, 얼마나 남았는지를 직관적으로 보여줍니다. 컨텍스트가 꽉 차면 이전 대화를 잊기 시작하므로, 현재 상태를 아는 것이 중요합니다.

**문법:**
```
/context
```

**예시:** `/context`를 실행하면 시각적 그리드가 나옵니다:
- 각 셀이 컨텍스트 윈도우의 일부를 나타냄
- 색상으로 사용량 표시
- 사용/잔여 비율을 직관적으로 파악 가능

**실습:** `/context`를 실행하고, 컨텍스트 사용량이 **대략 몇 %**인지 알려주세요.

**확인:** 수치를 확인하고 현재 상태와 연결지어 안내합니다 (예: "아직 여유가 있네요" 또는 "꽤 찼으니 이런 때 `/compact`를 쓰면 됩니다"). 일반적으로 80%를 넘으면 compact를 고려할 시점입니다.

**팁:** `/context`로 확인하고, 많이 찼으면 `/compact`로 정리하는 조합으로 사용하세요. 스마트폰 저장 공간을 확인하고 정리하는 것과 비슷합니다.

---

## 4.3 /cost

**설명:** `/cost`는 현재 세션의 API 토큰 사용량과 예상 비용을 보여줍니다. **이 커맨드는 API 사용자(토큰당 과금) 대상입니다.** Claude Max나 Pro 구독자는 사용량이 구독에 포함되어 있으므로, `/cost` 데이터가 과금과 관련 없습니다. 구독자는 다음에 배울 `/stats`를 사용하세요.

**문법:**
```
/cost
```

**예시:** API 요금제에서 실행하면 이런 정보가 나옵니다:
```
Total cost:            $0.55
Total duration (API):  6m 19.7s
Total duration (wall): 6h 33m 10.2s
Total code changes:    0 lines added, 0 lines removed
```

**참고:** 구독 플랜(Max/Pro)에서는 `/help` 목록에 `/cost`가 나타나지 않을 수 있습니다. API 과금 기반이 아니기 때문입니다. 보이지 않는다면 정상이니, `/stats`를 사용하세요.

**실습:** API 요금제라면 `/cost`를 실행하고, 이 세션의 **총 비용**을 알려주세요. 구독 플랜이라면 다음 섹션(`/stats`)으로 건너뛰세요.

**확인:** 비용을 확인합니다. 긴 세션이나 Opus 사용 시 비용이 빠르게 올라갈 수 있으므로, 주기적으로 확인하는 습관이 도움됩니다.

**팁:** API 사용자의 경우, 긴 세션에서 `/cost`를 중간중간 확인하세요. 특히 Opus 사용 시 토큰 소모가 빠릅니다. Claude Code 시작 시 `--max-budget-usd` 플래그를 설정하면 예상치 못한 비용을 방지할 수 있습니다.

---

## 4.4 /stats

**설명:** `/stats`는 Claude Code 사용 패턴을 시각화합니다 — 일별 사용량, 세션 기록, 스트릭, 모델 선호도 등. `/cost`가 API 과금에 초점을 맞춘다면, `/stats`는 시간에 따른 사용 패턴을 보여줍니다. 구독자에게 권장되는 사용량 확인 커맨드입니다.

**문법:**
```
/stats
```

**예시:** `/stats`를 실행하면 이런 시각화가 나옵니다:
- 일별/주별 사용 패턴
- 세션 기록과 시간
- 가장 많이 사용한 모델
- 사용 스트릭

**실습:** `/stats`를 실행하고, 가장 많이 사용한 **모델 이름**을 알려주세요. 데이터가 아직 없다면 "없음"이라고 답하면 됩니다.

**확인:** 답변을 확인합니다. 사용 패턴을 파악하면 워크플로우 최적화에 도움됩니다 — 예를 들어 Sonnet이면 충분한 작업에 Opus를 쓰고 있다면 비용을 줄일 수 있습니다.

**팁:** `/stats`를 통해 자신의 작업 습관을 파악할 수 있습니다. 예를 들어, Sonnet이면 충분한 작업에 Opus를 쓰고 있다든가, 긴 세션에서 compact를 안 하고 있다든가 하는 패턴을 발견하면 워크플로우를 최적화하는 데 도움이 됩니다.

---

## 모듈 4 완료!

**진행률: [########........] 4/7 모듈 완료**

컨텍스트와 사용량 관리 커맨드를 배웠습니다:
- `/compact` — 대화 압축으로 컨텍스트 절약
- `/context` — 컨텍스트 사용량 시각화
- `/cost` — API 토큰 비용 추적 (API 사용자)
- `/stats` — 사용 패턴과 기록 확인 (모든 사용자)

다음은 **모듈 5 — 세션 관리**입니다. 이전 세션 재개, 되돌리기, 이름 변경, 복사 방법을 배웁니다.

계속할까요? 준비되면 `05-session-management.md`를 열어주세요.
